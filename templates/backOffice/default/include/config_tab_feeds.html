<div class="panel panel-default">
    <div class="panel-heading clearfix">
        <div class="panel-title">
            {intl l="Google feeds configuration"}
        </div>
    </div>
    <div class="panel-body">

        <div class="alert alert-info">
            <li>
            {intl l='To upload your products in Google Shopping, you must first create a Google Merchant Account at %link.' link='<a href="https://merchants.google.com/">https://merchants.google.com/</a>'}
            </li>
            <li>
            {intl l='Within the Google Merchant Center, you have to create "feeds" for each language and currency that you target.'}
            {intl l='You can then add multiple countries to each of your feeds.'}
            </li>
            <li>
            {intl l='Once your feeds are set up in Google Merchant, re-create your feeds below with the same informations.'}
            </li>
            <li>
            {intl l='Finally, you will provide your product list to Google for each feed through a XML file.'}
            {intl l='For that, you can set up a automated fetch in Google Merchant Center by providing the link to the XML file (Right-click the "XML" blue button, then "Copy link address") or upload the file manually.'}
            </li>
        </div>

        <div class="alert alert-help">
            {form name="googleshoppingxml.feed.management"}
            <div class="row">
                <form method="post" action='{url path="/admin/module/googleshoppingxml/feed/add"}'>
                    {form_hidden_fields form=$form}
                    {form_field form=$form field="feed_label"}
                    <div class="form-group col-md-2 {if $error}has-error{/if}">
                        <label for="{$label_attr.for}">{$label}</label>
                        <input id="{$label_attr.for}" class="form-control" name="{$name}" required/>
                    </div>
                    {/form_field}

                    {form_field form=$form field="lang_id"}
                    <div class="form-group col-md-2 {if $error}has-error{/if}">
                        <label for="{$label_attr.for}">{$label}</label>
                        <select id="{$label_attr.for}" class="form-control" name="{$name}">
                            {loop type="lang" name="lang_id"}
                            <option value="{$ID}">{$TITLE}</option>
                            {/loop}
                        </select>
                    </div>
                    {/form_field}

                    {form_field form=$form field="currency_id"}
                    <div class="form-group col-md-2 {if $error}has-error{/if}">
                        <label for="{$label_attr.for}">{$label}</label>
                        <select id="{$label_attr.for}" class="form-control" name="{$name}">
                            {loop type="currency" name="currency_id"}
                            <option value="{$ID}">{$SYMBOL}</option>
                            {/loop}
                        </select>
                    </div>
                    {/form_field}

                    {form_field form=$form field="country_list_id"}
                    <div class="form-group col-md-3 {if $error}has-error{/if}">
                        <label for="{$label_attr.for}">{$label}</label>

                        <div class="well feed_country_list_container" data-feedid="new">
                        </div>

                        <div class="input-group">
                            <select class="js_select_visible_feed_add_country form-control" data-feedid="new">
                                <option value="0">-- {intl l="Add a country"} --</option>

                                {loop type="country" name="loop_country_add_feed"}
                                <option value="{$ID}">{$TITLE}</option>
                                {/loop}
                            </select>

                            <span class="input-group-btn">
                                <a href="#" class="btn btn-secondary js_btn_feed_add_country" data-feedid="new">
                                    <span class="glyphicon glyphicon-plus"></span>
                                </a>
                            </span>
                        </div>


                        <select id="{$label_attr.for}" class="form-control js_select_hidden_feed_add_country" name="{$name}" data-feedid="new" multiple hidden>
                            {loop type="country" name="country_id"}
                            <option value="{$ID}">{$TITLE}</option>
                            {/loop}
                        </select>
                    </div>
                    {/form_field}

                    <div class="form-group col-md-3">
                        <label class="control-label">&nbsp;</label>
                        <button class="btn btn-default btn-primary form-control" type="submit">
                            <span class="glyphicon glyphicon-plus"></span>
                            {intl l="Add"}
                        </button>
                    </div>
                </form>
            </div>
            {/form}
        </div>



        {loop type="googleshoppingxml.feed" name="googleshoppingxml_feed"}

        <div class="row">
            {form name="googleshoppingxml.feed.management"}
            <form method="post" action='{url path="/admin/module/googleshoppingxml/feed/update"}'>
                {form_hidden_fields form=$form}

                {form_field form=$form field="id"}
                {$ID_FEED = $ID}
                <input type="hidden" name="{$name}" value="{$ID}"/>
                {/form_field}

                {form_field form=$form field="feed_label"}
                <div class="form-group col-md-2 {if $error}has-error{/if}">
                    <input class="form-control" name="{$name}" value="{$LABEL}" required/>
                </div>
                {/form_field}

                {form_field form=$form field="lang_id"}
                <div class="form-group col-md-2 {if $error}has-error{/if}">
                    <select class="form-control" name="{$name}">
                        {loop type="lang" name="lang_id"}
                        <option value="{$ID}" {if $ID==$LANG_ID}selected{/if}>{$TITLE}</option>
                        {/loop}
                    </select>
                </div>
                {/form_field}

                {form_field form=$form field="currency_id"}
                <div class="form-group col-md-2 {if $error}has-error{/if}">
                    <select class="form-control" name="{$name}">
                        {loop type="currency" name="currency_id"}
                        <option value="{$ID}" {if $ID==$CURRENCY_ID}selected{/if}>{$SYMBOL}</option>
                        {/loop}
                    </select>
                </div>
                {/form_field}

                {form_field form=$form field="country_list_id"}
                <div class="form-group col-md-3 {if $error}has-error{/if}">
                    <div class="well feed_country_list_container" data-feedid="{$ID}">
                    </div>

                    <div class="input-group">
                        <select class="js_select_visible_feed_add_country form-control" data-feedid="{$ID}">
                            <option value="0">-- {intl l="Add a country"} --</option>

                            {loop type="country" name="loop_country_update_feed"}
                            <option value="{$ID}">{$TITLE}</option>
                            {/loop}
                        </select>

                        <span class="input-group-btn">
                            <a href="#" class="btn btn-secondary js_btn_feed_add_country" data-feedid="{$ID}">
                                <span class="glyphicon glyphicon-plus"></span>
                            </a>
                        </span>
                    </div>


                    <select class="form-control js_select_hidden_feed_add_country" name="{$name}" data-feedid="{$ID}" multiple>
                        {loop type="country" name="loop_hidden_country_update_feed"}
                        {$selected = in_array($ID, $COUNTRY_LIST_ID)}
                        <option value="{$ID}" {if $selected}selected{/if}>{$TITLE}</option>
                        {/loop}
                    </select>
                </div>
                {/form_field}


                <div class="form-group col-md-2">
                    <div class='btn-group'>
                        <button class="btn btn-success" type="submit">
                            <span class="glyphicon glyphicon-ok"></span>
                            {intl l="Save"}
                        </button>
                        <a class="btn btn-info" href="{url path="/admin/module/googleshoppingxml/feed/xml/{$ID}/feed.xml"}" style="margin-left:5px" download>
                            <span class="glyphicon glyphicon-chevron-left"></span>
                            {intl l="XML"}
                            <span class="glyphicon glyphicon-chevron-right"></span>
                        </a>
                    </div>
                </div>
            </form>
            {/form}

            <div class="form-group col-md-1">
                <form id="js_form_delete_feed_{$ID_FEED}" method="post" action="{url path='/admin/module/googleshoppingxml/feed/delete'}">
                    <input type="hidden" name="id_feed_to_delete" value="{$ID_FEED}"/>
                    <a class="btn btn-danger js_btn_delete_with_warning" style="margin-left:5px" data-formid="js_form_delete_feed_{$ID_FEED}">
                        <span class="glyphicon glyphicon-trash"></span>
                        {intl l="Delete"}
                    </a>
                </form>
            </div>
        </div>
        {/loop}

    </div>
</div>